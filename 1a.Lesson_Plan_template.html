<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lesson Plan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --primary: #0052cc;
      --primary-light: #e6f0ff;
      --bg: #f7f7fb;
      --text: #111827;
      --muted: #6b7280;
      --border: #e5e7eb;
      --radius-lg: 14px;
      --radius-md: 10px;
      --shadow-soft: 0 14px 35px rgba(15, 23, 42, 0.14);

      --module-color-a: #2563eb;
      --module-color-b: #16a34a;

      /* Special (yellow) */
      --special-bg: #fef9c3;
      --special-border: #eab308;

      --exam-bg: #fef2f2;
      --exam-border: #b91c1c;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      padding: 16px;
    }

    .page { max-width: 900px; margin: 0 auto; }

    /* ===== HEADER ===== */

    .header-card {
      background: white;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      padding: 16px 18px 14px;
      margin-bottom: 14px;
      border-top: 5px solid var(--primary);
    }

    .institution {
      text-transform: uppercase;
      font-size: 0.78rem;
      letter-spacing: 0.09em;
      color: var(--muted);
      font-weight: 600;
      margin-bottom: 2px;
    }

    .school-line {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .course-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 2px;
    }

    .course-meta {
      font-size: 0.86rem;
      color: var(--muted);
      display: flex;
      flex-wrap: wrap;
      gap: 6px 10px;
      align-items: center;
    }

    .badge {
      padding: 2px 7px;
      border-radius: 999px;
      background: #f3f4f6;
      font-size: 0.75rem;
      color: var(--muted);
    }

    .pill {
      display: inline-flex;
      align-items: center;
      padding: 3px 9px;
      border-radius: 999px;
      background: var(--primary-light);
      color: var(--primary);
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      user-select: none;
    }

    .pill-outline {
      background: #ffffff;
      border: 1px solid var(--primary-light);
      color: var(--primary);
    }

    .pill-active {
      background: var(--primary);
      color: #ffffff;
    }

    .pill + .pill {
      margin-left: 6px;
    }

    /* Links in header badges */
    .faculty-link,
    .course-link {
      color: inherit;
      text-decoration: none;
      display: inline-block;
    }

    .faculty-link:hover,
    .course-link:hover {
      text-decoration: underline;
    }

    /* ===== SUMMARY (for Lesson Plan tab) ===== */

    .summary-bar {
      margin-bottom: 10px;
      font-size: 0.78rem;
      color: var(--muted);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 6px;
    }

    .summary-item {
      display: inline-flex;
      align-items: center;
      gap: 3px;
      padding: 3px 7px;
      border-radius: 999px;
      background: #f9fafb;
      border: 1px solid var(--border);
    }

    /* ===== GENERIC CARD ===== */

    .card {
      background: white;
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      padding: 10px 10px 10px;
    }

    .card-title {
      font-weight: 650;
      font-size: 1rem;
      margin-bottom: 8px;
    }

    /* ===== LESSON PLAN VIEW ===== */

    .header-row {
      display: grid;
      grid-template-columns: 48px minmax(0, 1fr) auto;
      gap: 6px;
      padding: 4px 10px;
      font-size: 0.78rem;
      color: var(--muted);
      border-bottom: 1px solid var(--border);
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .lesson-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-top: 4px;
      margin-bottom: 4px;
    }

    .lesson-row {
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      padding: 6px 10px;
      display: grid;
      grid-template-columns: 48px minmax(0, 1fr) auto;
      gap: 6px;
      align-items: center;
      background: #ffffff;
    }

    .lesson-index {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--muted);
      text-align: center;
    }

    .lesson-module {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .module-tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 0.78rem;
      font-weight: 600;
      color: #ffffff;
      white-space: nowrap;
      width: fit-content;
      max-width: 100%;
    }

    .module-a { background: var(--module-color-a); }
    .module-b { background: var(--module-color-b); }

    .special-tag {
      background: var(--special-bg);
      color: #854d0e;
      border: 1px solid var(--special-border);
    }

    .lesson-notes {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .lesson-date {
      font-size: 0.78rem;
      color: var(--muted);
      text-align: right;
      white-space: nowrap;
    }

    .lesson-row.special {
      border-color: var(--special-border);
      background: var(--special-bg);
    }

    .lesson-row.exam {
      border-color: var(--exam-border);
      background: var(--exam-bg);
      grid-template-columns: 48px minmax(0, 1fr) auto;
    }

    .exam-title {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .exam-range {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .exam-badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 0.72rem;
      font-weight: 600;
      background: #fee2e2;
      color: var(--exam-border);
    }

    .footer-note {
      margin-top: 10px;
      font-size: 0.75rem;
      color: var(--muted);
      text-align: right;
    }

    /* ===== OUTCOMES VIEW ===== */

    .outcomes-view {
      display: none;
      font-size: 0.9rem;
      color: var(--text);
    }

    .outcomes-view p {
      font-size: 0.9rem;
      margin-bottom: 6px;
    }

    .outcomes-view ul {
      padding-left: 18px;
      margin-bottom: 8px;
    }

    .outcomes-view ol {
      padding-left: 18px;
      margin-bottom: 8px;
    }

    .outcomes-section {
      padding: 8px 10px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: #f9fafb;
      margin-bottom: 8px;
    }

    .outcomes-section-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .outcomes-highlight {
      font-weight: 600;
    }

    /* ===== SYLLABUS VIEW ===== */

    .syllabus-view {
      display: none;
      font-size: 0.9rem;
      color: var(--text);
    }

    .syllabus-section {
      padding: 8px 10px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: #f9fafb;
      margin-bottom: 8px;
    }

    .syllabus-section-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .syllabus-view ul {
      padding-left: 18px;
      margin-bottom: 6px;
    }

    .syllabus-tag {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: #e0f2fe;
      color: #075985;
      margin-bottom: 4px;
    }

    /* ===== EVALUATION VIEW ===== */

    .evaluation-view {
      display: none;
      font-size: 0.9rem;
      color: var(--text);
    }

    .evaluation-table-wrapper {
      overflow-x: auto;
      margin-top: 6px;
    }

    table.evaluation-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }

    table.evaluation-table th,
    table.evaluation-table td {
      border: 1px solid #d1d5db;
      padding: 6px 8px;
      text-align: center;
    }

    table.evaluation-table th {
      background: #0ea5e9;
      color: #ffffff;
      font-weight: 600;
    }

    table.evaluation-table th[colspan] {
      background: #0284c7;
    }

    table.evaluation-table td {
      background: #f9fafb;
    }

    table.evaluation-table tr:nth-child(even) td {
      background: #e5f3fb;
    }

    .eval-title {
      text-align: center;
      font-weight: 700;
      color: #1d4ed8;
      margin-bottom: 8px;
      font-size: 1rem;
    }

    .eval-note {
      margin-top: 8px;
      font-size: 0.8rem;
      color: #6b7280;
    }

    @media (max-width: 600px) {
      .header-row { font-size: 0.7rem; }
      .lesson-row { font-size: 0.85rem; }
      .course-meta { gap: 4px 6px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- HEADER -->
    <header class="header-card">
      <div class="institution" id="instName"></div>
      <div class="school-line" id="schoolLine"></div>
      <div class="course-title" id="courseTitle"></div>

      <div class="course-meta">
        <!-- course code badge (single source: config) -->
        <span class="badge" id="courseCode"></span>

        <span class="badge" id="semester"></span>

        <!-- faculty clickable -->
        <span class="badge" id="faculty"></span><br>

        <!-- TABS -->
        <span class="pill pill-active" id="tabLessonPlan">Lesson Plan</span>
        <span class="pill pill-outline" id="tabSyllabus">Syllabus</span>
        <span class="pill pill-outline" id="tabOutcomes">Outcomes</span>
        <span class="pill pill-outline" id="tabEvaluation">Evaluation</span>
      </div>
    </header>

    <!-- SUMMARY (only for Lesson Plan) -->
    <section class="summary-bar" id="summaryBar"></section>

    <!-- MAIN CARD WITH VIEWS -->
    <main class="card">
      <!-- LESSON PLAN VIEW -->
      <div id="lessonPlanView">
        <div class="card-title">Detailed Lesson Plan</div>
        <div class="header-row">
          <div></div>
          <div>Topic Covered</div>
          <div style="text-align:right;">Date</div>
        </div>
        <ul class="lesson-list" id="lessonList"></ul>
      </div>

      <!-- OUTCOMES VIEW (auto-generated from config) -->
      <div id="outcomesView" class="outcomes-view">
        <section class="outcomes-section">
          <div class="outcomes-section-title">Course Objective</div>
          <p id="courseObjective"></p>
        </section>

        <section class="outcomes-section">
          <div class="outcomes-section-title">Course Outcomes (COs)</div>
          <p>Upon completion of the course, the students will be able to:</p>
          <ul id="courseOutcomesList"></ul>
        </section>

        <section class="outcomes-section">
          <div class="outcomes-section-title">Programme Outcomes</div>
          <ol id="programmeOutcomesList"></ol>
        </section>
      </div>

      <!-- SYLLABUS VIEW (auto-generated from config) -->
      <div id="syllabusView" class="syllabus-view">
        <section class="syllabus-section">
          <div class="syllabus-section-title">Course Details</div>
          <ul id="courseDetailsList"></ul>
        </section>

        <br><div class="card-title">Syllabus</div>
        <div id="syllabusModulesContainer"></div>

        <br>
        <div class="card-title">Books</div>

        <section class="syllabus-section">
          <div class="syllabus-section-title">Text Books</div>
          <ul id="textBooksList"></ul>
        </section>
        <section class="syllabus-section">
          <div class="syllabus-section-title">Reference Books</div>
          <ul id="refBooksList"></ul>
        </section>
      </div>

      <!-- EVALUATION VIEW -->
      <div id="evaluationView" class="evaluation-view">
        <div class="eval-title">Evaluation Plan</div>
        <div class="evaluation-table-wrapper">
          <table class="evaluation-table">
            <thead>
              <tr>
                <th rowspan="2">S.No</th>
                <th rowspan="2">Evaluation Component</th>
                <th rowspan="2">Course Module</th>
                <th rowspan="2">Course Lecture No.</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>Activity Based Learning<br>(30 Marks)</td>
                <td>M1 to M4</td>
                <td>1 to 26</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Mid Sem Examination<br>(20 Marks)</td>
                <td>M1 to M2</td>
                <td>1 to 12</td>
              </tr>
              <tr>
                <td>3</td>
                <td>End Sem Examination<br>(50 Marks)</td>
                <td>M1 to M4</td>
                <td>1 to 26</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p class="eval-note">
          Note: The above evaluation structure indicates how marks are distributed across activity based learning,
          mid-semester and end-semester examinations, and the corresponding coverage of course modules and lecture numbers.
        </p>
      </div>
    </main>

    <div class="footer-note">
      Contact the concerned faculty for further clarifications.
    </div>
  </div>

  <script>
    /* ========== 1. CONFIG – EDIT THIS BLOCK ONLY ========== */

    const config = {
      // ===== BASIC COURSE DETAILS =====
      instituteName: "Kalinga Institute of Industrial Technology, Bhubaneswar",
      schoolLine: "(Deemed to be University)",
      planLabel: "Lesson Plan",
      semester: "Spring Sem 2025–2026",

      faculty: "Prof.Thotakura NSC Sekhar",
      facultylink: "https://my.e-kard.in/sekhar",


      courseTitle: "Basic Electrical Engineering",
      courseCode: "EE10002",
      courselink: "",


      // Course meta
      courseMeta: {
        credits: 2,
        ltp: "2-0-0",
        prereq: "Nil"
      },

      // Course objective & outcomes
      courseObjective:
        "To provide a comprehensive idea about circuit analysis, working principles of electrical machines, " +
        "a brief idea about magnetic circuits, and to understand the basics of the protection system.",

      courseOutcomes: [
        { id: "CO1", text: "Analyze the concept of DC circuit." },
        { id: "CO2", text: "Understand the concepts of AC circuits." },
        { id: "CO3", text: "Analyze the three-phase AC circuit." },
        { id: "CO4", text: "Interpret the behavior of magnetic circuits." },
        { id: "CO5", text: "Remember the principles and operation of electrical machines." },
        { id: "CO6", text: "Know the concepts of electrical safety and protection systems." }
      ],

      // Holidays, dates, etc.
      holidays: [
        "25-12-2025",
        "01-04-2026"
      ],

      startDate: "03-12-2025",
      classDays: ["Mon", "Fri"],

      midSem: {
        title: "Mid Semester Examination",
        start: "02-02-2026",
        end:   "07-02-2026"
      },
      endSem: {
        title: "End Semester Examination",
        start: "13-04-2026",
        end:   "20-04-2026"
      },

      // ===== SYLLABUS (single source for modules) =====
      syllabus: {
        modules: [
          {
            id: "M1",
            tag: "M1 – DC Circuits",
            description:
              "Kirchhoff’s law, Source transformation, Star-delta transformation and equivalent resistance of the circuits, Mesh and Nodal analysis, Superposition theorem."
          },
          {
            id: "M2",
            tag: "M2 – AC Circuits",
            description:
              "Peak, average, R.M.S. values of sinusoidal quantities, Peak factor, Form factor, Phase difference, Phasor representation, AC through R, L, C, AC Series Circuit (RL, RC, RLC), Three-phase AC circuits: Voltage, current and power in star and delta connections."
          },
          {
            id: "M3",
            tag: "M3 – Electromagnetic Circuits",
            description:
              "Magnetizing Force, Reluctance, Permeance, Magnetic field, Magnetic permeability, Analogy between Electric Circuits and Magnetic Circuits. Series magnetic circuit, BH curve."
          },
          {
            id: "M4",
            tag: "M4 – Scope & Safety",
            description:
              "Electrical Energy Scenario in India, Application of Transformer, Three-phase and single-phase induction Motors, Power ratings of air conditioners, PCs, laptops, printers, refrigerator, washing machine, different lamps, electricity tariff, calculation of electricity bill for domestic consumer.<br><br>" +
              "<strong>Personal Safety Measures:</strong> Electric Shock, Earthing and its types, Safety Precautions to avoid shock.<br><br>" +
              "<strong>Equipment Safety Measures:</strong> Working principles of fuse and miniature circuit breaker (MCB), Residual Current Circuit Breaker (RCCB)."
          }
        ],
        textBooks: [
          "Principles of Electrical Engineering and Electronics- V K Mehta, Rohit Mehta, S Chand and Company, New Delhi (Revised Edition 2013).",
          "Basic Electrical Engineering by D.C. Kulshreshtha, Tata Mcgraw publication, 1st Edition 2011.",
          "Basic Electrical Engineering, T.K. Nagasarkar and M.S. Sukhija, Oxford University press, 3rd Edition 2017."
        ],
        referenceBooks: [
          "Basics Electrical Engineering Sanjeev Sharma, I.K.International, New Delhi (Third Reprint 2010)."
        ]
      },

      // ===== LESSONS (use module IDs only) =====
      lessons: [
        { type: "special", label: "Introduction to Course" },
        { type: "class", module: "M1", notes: "Basic terminology: circuit/network, active/passive, linear/nonlinear, bilateral/unilateral, voltage, current sources." },
        { type: "class", module: "M1", notes: "Series/parallel combination of resistances, current & voltage division rules" },
        { type: "class", module: "M1", notes: "KCL & KVL with numericals." },
        { type: "class", module: "M1", notes: "Source transformation with basic numerical problems." },
        { type: "class", module: "M1", notes: "Star–Delta transformation with numericals. (Derivations are not required)" },

        { type: "special", label: "Doubt Clearing Session" },

        { type: "class", module: "M1", notes: "Mesh analysis with independent voltage source (no super-mesh), numericals." },
        { type: "class", module: "M1", notes: "Nodal analysis with independent sources (no super-node), numericals." },
        { type: "class", module: "M2", notes: "AC Basics: Amplitude, Time Period, Frequency, Phase, Phase difference; average value (full & half cycle Derivations)." },
        { type: "class", module: "M2", notes: "RMS value (Derivations), form factor & peak factor." },
        { type: "class", module: "M2", notes: "Problems on AC fundamentals." },

        { type: "special", label: "Doubt Clearing Session" },
        { type: "special", label: "Discussion of previous year mid-sem questions" },

        { type: "exam_mid" },

        { type: "class", module: "M2", notes: "Phasor representation of AC, Phasor Algebra both Polar & Rectangular." },
        { type: "class", module: "M2", notes: "AC through R, L, C Circuit Analysis" },
        { type: "class", module: "M2", notes: "Probs on AC through R, L, C Circuit" },
        { type: "class", module: "M2", notes: "AC Series RL, RC, RLC circuit Analysis" },
        { type: "class", module: "M2", notes: "Probs on AC Series RL, RC, RLC circuit Analysis" },
        { type: "class", module: "M2", notes: "3-Phase AC System(Star-Delta), 3-Phase Power equations & Probs" },
        { type: "class", module: "M2", notes: "Single-phase vs three-phase systems" },
        { type: "special", label: "Doubt Session & Revision" },
        { type: "class", module: "M3", notes: "Basic terminology, Analogy between Electric and Magnetic Circuits." },
        { type: "class", module: "M3", notes: "Analysis of Series Magnetic circuits with Probs." },
        { type: "class", module: "M3", notes: "B–H curve and hysteresis loop concepts." },
        { type: "class", module: "M4", notes: "Indian Electricity till date, 1-ph transformer principle & applications" },
        { type: "class", module: "M4", notes: "3-ph, 1-ph Induction motor principle & applications" },
        { type: "class", module: "M4", notes: "Power ratings of air conditioners, PCs, laptops, printers, refrigerator, washing machine, different lamps, electricity tariff, calculation of electricity bill for domestic consumers (with numerical problems)." },
        { type: "class", module: "M4", notes: "Personal safety measures: Electric Shock, Earthing and its types, Safety Precautions to avoid shock." },
        { type: "class", module: "M4", notes: "Equipment Safety measures: Working principle of Fuse and Miniature circuit breaker (MCB), Residual Current Circuit Breaker (RCCB)" },

        { type: "special", label: "Final Doubt Session & Revision" },

        { type: "exam_end" }
      ],


      programmeOutcomes: [
        {
          title: "Engineering knowledge:",
          text: "Apply the knowledge of mathematics, science, engineering fundamentals, and an engineering specialization to the solution of complex engineering problems."
        },
        {
          title: "Problem analysis:",
          text: "Identify, formulate, review research literature, and analyze complex engineering problems reaching substantiated conclusions using first principles of mathematics, natural sciences, and engineering sciences."
        },
        {
          title: "Design/development of solutions:",
          text: "Design solutions for complex engineering problems and design system components or processes that meet the specified needs with appropriate consideration for the public health and safety, and the cultural, societal, and environmental considerations."
        },
        {
          title: "Conduct investigations of complex problems:",
          text: "Use research-based knowledge and research methods including design of experiments, analysis and interpretation of data, and synthesis of the information to provide valid conclusions."
        },
        {
          title: "Modern tool usage:",
          text: "Create, select, and apply appropriate techniques, resources, and modern engineering and IT tools including prediction and modeling to complex engineering activities with an understanding of the limitations."
        },
        {
          title: "The engineer and society:",
          text: "Apply reasoning informed by the contextual knowledge to assess societal, health, safety, legal and cultural issues and the consequent responsibilities relevant to the professional engineering practice."
        },
        {
          title: "Environment and sustainability:",
          text: "Understand the impact of the professional engineering solutions in societal and environmental contexts, and demonstrate the knowledge of, and need for sustainable development."
        },
        {
          title: "Ethics:",
          text: "Apply ethical principles and commit to professional ethics and responsibilities and norms of the engineering practice."
        },
        {
          title: "Individual and team work:",
          text: "Function effectively as an individual, and as a member or leader in diverse teams, and in multidisciplinary settings."
        },
        {
          title: "Communication:",
          text: "Communicate effectively on complex engineering activities with the engineering community and with society at large, such as, being able to comprehend and write effective reports and design documentation, make effective presentations, and give and receive clear instructions."
        },
        {
          title: "Project management and finance:",
          text: "Demonstrate knowledge and understanding of the engineering and management principles and apply these to one’s own work, as a member and leader in a team, to manage projects and in multidisciplinary environments."
        },
        {
          title: "Life-long learning:",
          text: "Recognize the need for, and have the preparation and ability to engage in independent and life-long learning in the broadest context of technological change."
        },
        {
          title: "Demonstrate knowledge and hands-on competence",
          text: "in the area of characteristics, operations, analysis, design of Electrical Machines and their applications in industry and other fields."
        },
        {
          title: "Demonstrate knowledge of analysis, design and implementation",
          text: "of electrical circuits, electronic circuits, power electronic circuits, measurements, control systems in different electrical systems."
        },
        {
          title: "Enhance the knowledge in generation, transmission, distribution,",
          text: "protection of electric power, installation, operation and maintenance of power system components with respect to competitive tariff for economic project viability and climate change issues and to understand the need for renewable energy systems for developing clean energy and sustainable technologies."
        }
      ]
    };

    /* ========== 2. UTILITIES ========== */

    const dayMapShortToNum = { Sun: 0, Mon: 1, Tue: 2, Wed: 3, Thu: 4, Fri: 5, Sat: 6 };

    function parseDDMMYYYY(str) {
      const [dd, mm, yyyy] = str.split("-");
      return new Date(parseInt(yyyy, 10), parseInt(mm, 10) - 1, parseInt(dd, 10));
    }

    function formatDateDDMMMYYYY(date) {
      const d = String(date.getDate()).padStart(2, "0");
      const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      const m = months[date.getMonth()];
      const y = date.getFullYear();
      return `${d}-${m}-${y}`;
    }

    function inRange(d, start, end) {
      return d.getTime() >= start.getTime() && d.getTime() <= end.getTime();
    }

    function makeHolidaySet(holidays) {
      const set = new Set();
      holidays.forEach(h => {
        const d = parseDDMMYYYY(h);
        set.add(d.toISOString().slice(0, 10));
      });
      return set;
    }

    function buildModuleColorMap(modulesMap) {
      const keys = Object.keys(modulesMap);
      const map = {};
      keys.forEach((key, idx) => {
        map[key] = (idx % 2 === 0) ? "module-a" : "module-b";
      });
      return map;
    }

    function buildModulesFromSyllabus(cfg) {
      const map = {};
      (cfg.syllabus.modules || []).forEach(m => {
        map[m.id] = m.tag;
      });
      return map;
    }

    /* ========== 3. SCHEDULE GENERATION ========== */

    function generateSchedule(cfg) {
      const lessonsOut = [];
      const startDate = parseDDMMYYYY(cfg.startDate);
      const classDays = cfg.classDays.map(d => dayMapShortToNum[d]);

      const midStart = cfg.midSem?.start ? parseDDMMYYYY(cfg.midSem.start) : null;
      const midEnd   = cfg.midSem?.end   ? parseDDMMYYYY(cfg.midSem.end)   : null;
      const endStart = cfg.endSem?.start ? parseDDMMYYYY(cfg.endSem.start) : null;
      const endEnd   = cfg.endSem?.end   ? parseDDMMYYYY(cfg.endSem.end)   : null;

      const holidaysSet = makeHolidaySet(cfg.holidays || []);

      let currentDate = new Date(startDate);
      let idxLesson = 0;
      let classNumber = 0;
      let midInserted = false;
      let endInserted = false;

      function isHoliday(date) {
        const iso = date.toISOString().slice(0, 10);
        return holidaysSet.has(iso);
      }

      function nextValidClassDate(date) {
        const d = new Date(date);
        while (true) {
          const dayNum = d.getDay();
          const isClassDay = classDays.includes(dayNum);
          const insideMid = midStart && midEnd && inRange(d, midStart, midEnd);
          const insideEnd = endStart && endEnd && inRange(d, endStart, endEnd);
          if (isClassDay && !insideMid && !insideEnd && !isHoliday(d)) {
            return d;
          }
          d.setDate(d.getDate() + 1);
        }
      }

      while (idxLesson < cfg.lessons.length && idxLesson < 400) {
        const base = cfg.lessons[idxLesson];

        if (base.type === "exam_mid" && midStart && midEnd && !midInserted) {
          lessonsOut.push({
            type: "exam_mid",
            title: cfg.midSem.title,
            start: midStart,
            end: midEnd
          });
          midInserted = true;
          currentDate = new Date(midEnd);
          currentDate.setDate(currentDate.getDate() + 1);
          idxLesson++;
          continue;
        }

        if (base.type === "exam_end" && endStart && endEnd && !endInserted) {
          lessonsOut.push({
            type: "exam_end",
            title: cfg.endSem.title,
            start: endStart,
            end: endEnd
          });
          endInserted = true;
          currentDate = new Date(endEnd);
          currentDate.setDate(currentDate.getDate() + 1);
          idxLesson++;
          continue;
        }

        if (base.type === "class" || base.type === "special") {
          const nextDate = nextValidClassDate(currentDate);
          classNumber++;

          lessonsOut.push({
            type: base.type,
            classNo: classNumber,
            module: base.module || null,
            label: base.label || null,
            notes: base.notes || "",
            date: nextDate
          });

          currentDate = new Date(nextDate);
          currentDate.setDate(currentDate.getDate() + 1);
          idxLesson++;
          continue;
        }

        idxLesson++;
      }

      return lessonsOut;
    }

    /* ========== 4. RENDERING: LESSON PLAN ========= */

    function renderLessonPlan(cfg) {
      document.getElementById("instName").textContent = cfg.instituteName;
      document.getElementById("schoolLine").textContent = cfg.schoolLine;
      document.getElementById("courseTitle").textContent = cfg.courseTitle;
      document.getElementById("semester").textContent = cfg.semester;

      // course code (single source with link from config)
      const codeEl = document.getElementById("courseCode");
      const codeHref = cfg.courselink || "#";
      codeEl.innerHTML = `
        <a
          href="${codeHref}"
          target="_blank"
          rel="noopener noreferrer"
          class="course-link"
        >
          ${cfg.courseCode}
        </a>
      `;

      // faculty from config (name + link)
      const facultyEl = document.getElementById("faculty");
      const facultyHref = cfg.facultylink || "#";
      facultyEl.innerHTML = `
        <a
          href="${facultyHref}"
          target="_blank"
          rel="noopener noreferrer"
          class="faculty-link"
        >
          ${cfg.faculty}
        </a>
      `;

      const schedule = generateSchedule(cfg);

      // build modules map from syllabus
      const modulesMap = buildModulesFromSyllabus(cfg);
      const moduleColorMap = buildModuleColorMap(modulesMap);

      const totalClasses = schedule.filter(s => s.type === "class" || s.type === "special").length;
      const specialCount = schedule.filter(s => s.type === "special").length;

      const summaryBar = document.getElementById("summaryBar");
      summaryBar.innerHTML = `
        <span class="summary-item"><strong>${totalClasses - specialCount}</strong> Regular classes</span>
        <span class="summary-item"><strong>${specialCount}</strong> Special classes</span>
        <span class="summary-item">Start: <strong>${cfg.startDate}</strong></span>
        <span class="summary-item">Days: <strong>${cfg.classDays.join(", ")}</strong></span>
      `;

      const list = document.getElementById("lessonList");
      list.innerHTML = "";

      schedule.forEach(item => {
        const li = document.createElement("li");
        li.classList.add("lesson-row");

        const colIndex = document.createElement("div");
        colIndex.className = "lesson-index";

        const colModule = document.createElement("div");
        colModule.className = "lesson-module";

        const colDate = document.createElement("div");
        colDate.className = "lesson-date";

        if (item.type === "exam_mid" || item.type === "exam_end") {
          li.classList.add("exam");
          colIndex.textContent = "—";

          const title = document.createElement("div");
          title.className = "exam-title";
          title.textContent = item.title;

          const range = document.createElement("div");
          range.className = "exam-range";
          range.textContent = `${formatDateDDMMMYYYY(item.start)} – ${formatDateDDMMMYYYY(item.end)}`;

          colModule.appendChild(title);
          colModule.appendChild(range);

          const badge = document.createElement("span");
          badge.className = "exam-badge";
          badge.textContent = "EXAM";
          colDate.appendChild(badge);

          li.appendChild(colIndex);
          li.appendChild(colModule);
          li.appendChild(colDate);
          list.appendChild(li);
          return;
        }

        if (item.type === "special") {
          li.classList.add("special");
        }

        colIndex.textContent = item.classNo;

        const tag = document.createElement("span");
        tag.className = "module-tag";

        if (item.module && modulesMap[item.module]) {
          const colorClass = moduleColorMap[item.module] || "module-a";
          tag.classList.add(colorClass);
          tag.textContent = modulesMap[item.module];
        } else {
          tag.classList.add("special-tag");
          tag.textContent = item.label || "Special Class";
        }

        if (item.type === "special") {
          if (item.module && modulesMap[item.module]) {
            tag.textContent = `${modulesMap[item.module]} · ${item.label || "Special"}`;
          } else if (item.label) {
            tag.textContent = item.label;
          }
        }

        colModule.appendChild(tag);

        if (item.notes) {
          const notesDiv = document.createElement("div");
          notesDiv.className = "lesson-notes";
          notesDiv.textContent = item.notes;
          colModule.appendChild(notesDiv);
        }

        colDate.textContent = formatDateDDMMMYYYY(item.date);

        li.appendChild(colIndex);
        li.appendChild(colModule);
        li.appendChild(colDate);
        list.appendChild(li);
      });
    }

    /* ========== 5. RENDERING: SYLLABUS ========= */

    function renderSyllabus(cfg) {
      // course details
      const detailsEl = document.getElementById("courseDetailsList");
      detailsEl.innerHTML = `
        <li>Credits: ${cfg.courseMeta.credits}</li>
        <li>L-T-P: ${cfg.courseMeta.ltp}</li>
        <li>Pre-requisite: ${cfg.courseMeta.prereq}</li>
      `;

      // modules / syllabus tags from config.syllabus.modules
      const modulesContainer = document.getElementById("syllabusModulesContainer");
      modulesContainer.innerHTML = "";
      (cfg.syllabus.modules || []).forEach(m => {
        const sec = document.createElement("section");
        sec.className = "syllabus-section";
        sec.innerHTML = `
          <div class="syllabus-tag">${m.tag}</div><br>
          ${m.description}
        `;
        modulesContainer.appendChild(sec);
      });

      // books
      const textList = document.getElementById("textBooksList");
      textList.innerHTML = "";
      (cfg.syllabus.textBooks || []).forEach(b => {
        const li = document.createElement("li");
        li.textContent = b;
        textList.appendChild(li);
      });

      const refList = document.getElementById("refBooksList");
      refList.innerHTML = "";
      (cfg.syllabus.referenceBooks || []).forEach(b => {
        const li = document.createElement("li");
        li.textContent = b;
        refList.appendChild(li);
      });
    }

    /* ========== 6. RENDERING: OUTCOMES (Course + Programme) ========= */

    function renderOutcomes(cfg) {
      // Course objective
      document.getElementById("courseObjective").textContent = cfg.courseObjective;

      // Course outcomes
      const coList = document.getElementById("courseOutcomesList");
      coList.innerHTML = "";
      (cfg.courseOutcomes || []).forEach(co => {
        const li = document.createElement("li");
        li.innerHTML = `<span class="outcomes-highlight">${co.id}:</span> ${co.text}`;
        coList.appendChild(li);
      });

      // Programme outcomes
      const poList = document.getElementById("programmeOutcomesList");
      poList.innerHTML = "";
      (cfg.programmeOutcomes || []).forEach(po => {
        const li = document.createElement("li");
        if (po.title) {
          li.innerHTML = `<strong>${po.title}</strong> ${po.text}`;
        } else {
          li.textContent = po.text;
        }
        poList.appendChild(li);
      });
    }

    /* ========== 7. TABS ========= */

    function initTabs() {
      const tabLessonPlan = document.getElementById("tabLessonPlan");
      const tabOutcomes   = document.getElementById("tabOutcomes");
      const tabSyllabus   = document.getElementById("tabSyllabus");
      const tabEvaluation = document.getElementById("tabEvaluation");

      const lessonPlanView = document.getElementById("lessonPlanView");
      const outcomesView   = document.getElementById("outcomesView");
      const syllabusView   = document.getElementById("syllabusView");
      const evaluationView = document.getElementById("evaluationView");
      const summaryBar     = document.getElementById("summaryBar");

      const allTabs  = [tabLessonPlan, tabOutcomes, tabSyllabus, tabEvaluation];
      const allViews = [lessonPlanView, outcomesView, syllabusView, evaluationView];

      function activateTab(tab, view, showSummary) {
        allTabs.forEach(t => {
          t.classList.remove("pill-active");
          t.classList.add("pill-outline");
        });
        tab.classList.add("pill-active");
        tab.classList.remove("pill-outline");

        allViews.forEach(v => v.style.display = "none");
        view.style.display = "block";

        summaryBar.style.display = showSummary ? "flex" : "none";
      }

      tabLessonPlan.addEventListener("click", () =>
        activateTab(tabLessonPlan, lessonPlanView, true));
      tabOutcomes.addEventListener("click", () =>
        activateTab(tabOutcomes, outcomesView, false));
      tabSyllabus.addEventListener("click", () =>
        activateTab(tabSyllabus, syllabusView, false));
      tabEvaluation.addEventListener("click", () =>
        activateTab(tabEvaluation, evaluationView, false));

      // Default
      activateTab(tabLessonPlan, lessonPlanView, true);
    }

    /* ========== 8. INIT ========= */

    renderLessonPlan(config);
    renderSyllabus(config);
    renderOutcomes(config);
    initTabs();
  </script>
</body>
</html>
